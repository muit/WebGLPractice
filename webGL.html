<!DOCTYPE html>
<html>
<head>
    <!--Shader Vertex & Shader Fragments should be in order with -->

    <!--Shader: example -->
    <script class="VertexShader" type="x-shader/x-vertex">
        attribute highp vec3 VertexPosition;
        attribute highp vec2 TextureCoord;

        uniform highp mat4 TransformationMatrix;
        uniform highp mat4 PerspectiveMatrix;

        varying highp vec2 vTextureCoord;

        void main(void){
            gl_position = PerspectiveMatrix * TransformationMatrix * vec4(VertexPosition, 1.0);
            vTextureCoord = TextureCoord;
        }
    </script>
    <script class="FragmentShader" type="x-shader/x-fragment">
        varying highp vTextureCoord;

        uniform sampler2D uSampler;

        void main(void){
            highp vec4 texelColor = texture2D(uSampler, vec2(vTextureCoord.s, vTextureCoord.t));
            gl_FragColor = texelColor
        }
    </script>

    <script>
        function load(){
            var canvas = document.getElementById("canvas");

            this.glc = new GLC(canvas);
            glc.init();
        }

        //==============================
        //  GL Control Class
        //==============================
        var GLC = function(canvas){
            this.canvas = canvas;
        }

        GLC.prototype = {
            init: function(){
                this.gl = canvas.getContext("webgl") || canvas.getContext("experimental-webgl");
                if(!this.gl){
                    alert("Your browser doesn't support WebGL  :(");
                    return;
                }
                this.initGL();
                this.initShaders();
                this.initBuffers();
            },

            initGL: function(){
                this.gl.clearColor(0.0, 0.0, 0.0, 1.0);
                this.gl.clearDepth(1.0);
                this.gl.enable(this.gl.DEPTH_TEST);
                this.gl.depthFunc(this.gl.LEQUAL);
                this.aspectRatio = canvas.width/canvas.height;
            },

            initShaders: function(){
                var FShaders = document.getElementsByClassName("VertexShader");
                var VShaders = document.getElementsByClassName("FragmentShader");
                this.ShaderPrograms = [];


                if(FShaders.length <= 0 || VShaders.length <= 0){
                    alert("Could not find Shaders!");
                    return;
                }
                else if(FShaders.length != VShaders.length){
                    alert("Error, Shader without his pair.");
                    return;
                }
                var loadShader = function(script){
                    var code = "";
                    var currentChild = script.firstChild;
                    while(currentChild){
                        if(currentChild.nodeType == currentChild.TEXT_NODE)
                            code += currentChild.textContent;
                        currentChild = currentChild.nextSibling
                    }
                    return code;
                }

                // Load Shaders
                for(var i = 0, len = FShaders.length; i < len; i++){
                    //Fragment Shader
                    var code = loadShader(FShaders[i]);
                    FShaders[i] = this.gl.createShader(this.gl.FRAGMENT_SHADER);
                    this.gl.shaderSource(FShaders[i], code);
                    this.gl.compileShader(FShaders[i]);

                    //Vertex Shader
                    var code = loadShader(VShaders[i]);
                    VShaders[i] = this.gl.createShader(this.gl.VERTEX_SHADER);
                    this.gl.shaderSource(VShaders[i], code);
                    this.gl.compileShader(VShaders[i]);

                    //Shader Program
                    this.ShaderProgram[i] = this.gl.createProgram();
                    this.gl.attachShader(this.ShaderPrograms[i], FShaders[i]);
                    this.gl.attachShader(this.ShaderPrograms[i], VShaders[i]);
                    this.gl.linkProgram(this.ShaderPrograms[i]);
                    this.gl.useProgram(this.ShaderPrograms[i]);

                    //Link Vertex Position Attribute from Shader
                    var vertexPosition = this.gl.getAttibLocation(this.ShaderPrograms[i], "VertexPosition");
                    this.gl.enableVertexAttribArray(vertexPosition);

                    //Link Texture Coordinate Attribute from Shader
                    var vertexTexture = this.gl.getAttibLocation(this.ShaderPrograms[i], "TextureCoord");
                    this.gl.enableVertexAttribArray(vertexTexture);
                }

            },

            initBuffers: function(){

            },
        }


    </script>
</head>
<body onLoad="load()">
    <canvas id="canvas" width="500" height="500"></canvas>
</body>
</html>